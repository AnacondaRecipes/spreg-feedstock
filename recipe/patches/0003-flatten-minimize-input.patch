From cbfe03b8f9d8cf04ac4ca33b43f47aa4a853a9c2 Mon Sep 17 00:00:00 2001
From: Lorenzo Pirritano <lpirritano@anaconda.com>
Date: Mon, 10 Feb 2025 17:12:15 +0100
Subject: [PATCH 3/3] flatten minimize input

Taken from:
 https://github.com/pysal/spreg/commit/503316c4855a4ace846e2e8ec86601ffcb769d46

---
 spreg/sur_error.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/spreg/sur_error.py b/spreg/sur_error.py
index 80b96eb..966920e 100644
--- a/spreg/sur_error.py
+++ b/spreg/sur_error.py
@@ -486,7 +486,7 @@ class BaseSURerrorML():
             splXX,splXy = sur_crossprod(splX,sply)
             b1,varb1,sig1 = sur_est(splXX,splXy,splbigE,self.bigK)
             bigE = sur_resids(self.bigy,self.bigX,b1)
-            res = minimize(clik,lam,args=(self.n,self.n2,self.n_eq,\
+            res = minimize(clik,np.array(lam).flatten(),args=(self.n,self.n2,self.n_eq,\
                             bigE,I,WS),method='L-BFGS-B',\
                             bounds=lambdabounds)
             lam = res.x
-- 
2.39.1

